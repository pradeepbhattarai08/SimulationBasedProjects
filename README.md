# 🛡️ Simulation-Based Cybersecurity Projects

This repository contains walkthrough-based and setup-oriented simulation projects performed in virtualized environments using Linux, Snort, Splunk, and other security tools. These projects demonstrate practical applications in cybersecurity threat detection, monitoring, and mitigation.

---

## 🔗 Project Index

1. [🚨 DoS/DDoS Simulation, Detection & Mitigation](https://medium.com/@pradeepbhattarai08/ddos-attack-and-defense-7ce04a194b2c)
2. [📡 SIEM Pipeline: IDS to Splunk using Snort](https://medium.com/@pradeepbhattarai08/building-a-virtualized-ids-to-siem-pipeline-with-snort-and-splunk-4f8e8c634cef)

---

# 1️⃣ DoS/DDoS Simulation, Detection & Mitigation

This project simulates **Denial of Service (DoS)** and **Distributed Denial of Service (DDoS)** attacks within a controlled virtual environment to study their behavior, analyze their impact, and apply effective mitigation techniques.

---

## 🔧 Environment

- **Attacker Machine**: Kali Linux (VM)
- **Target Machine**: Metasploitable / Ubuntu Server (VM)
- **Network Setup**: NAT or Host-only Adapter (to simulate internal traffic while isolating from the internet)

---

## 🛠 Tools Used

### 🔹 Attack Tools:
- [`hulk.py`](https://github.com/grafov/hulk) – HTTP GET Flood tool
- [`Tor’s Hammer`](https://github.com/dotfighter/torshammer) – Slow HTTP POST flood (ACK/PUSH attack)
- `hping3` – Custom TCP/UDP/ICMP floods with IP spoofing capabilities

### 🔹 Monitoring Tools:
- `Wireshark` – Deep packet analysis
- `tcpdump` – Command-line packet capture
- `netstat` – Connection and socket monitoring

### 🔹 Defense Tools:
- `iptables` – Advanced firewall configuration
- `ufw` – Simplified firewall management

---

## 📌 Key Features

### ⚔️ Simulation:

- **Hulk.py**  
  - Launches HTTP GET request floods
  - Overwhelms the web server by exhausting its resources

- **Tor’s Hammer**  
  - Executes slow HTTP POST (Low & Slow attack)
  - Sends partial requests to consume server threads without completing the connection

- **hping3**  
  - Conducts network-layer attacks:
    - TCP SYN Flood
    - UDP Flood
    - ICMP Flood
    - Spoofed IP traffic to simulate botnet-based DDoS

---

### 🔬 Analysis:

- Real-time monitoring of:
  - CPU utilization
  - Connection states (`netstat`)
  - Packet patterns (`Wireshark` / `tcpdump`)
- Identifying attack vectors and traffic anomalies

---

### 🛡️ Mitigation:

- **Block Attacker IPs**:
  ```bash
  sudo iptables -A INPUT -s <attack-ip> -j DROP
  ---
- **Rate Limit Connections**:
  ```bash
  sudo iptables -A INPUT -p tcp --syn -m limit --limit 2/s --limit-burst 2 -j ACCEPT
  sudo iptables -A INPUT -p INPUT -p tcp --syn -j DROP
  ---

# 2️⃣ SIEM Pipeline: IDS to Splunk using Snort

This project builds a virtualized **Intrusion Detection System (IDS)** using **Snort**, integrated with **Splunk** for real-time log forwarding, monitoring, and visualization. It demonstrates how to create a functional SIEM pipeline in a lab environment.

---

## 🔧 Environment

- **Snort IDS VM**: Ubuntu Virtual Machine (acts as sensor)
- **Splunk Enterprise**: Hosted on the local (host) machine
- **Communication**: Port `9997` (used by Splunk Universal Forwarder)

---

## 🛠 Tools Used

- **[Snort](https://www.snort.org/)** – Open-source network intrusion detection system
- **[Splunk Universal Forwarder](https://www.splunk.com/en_us/download/universal-forwarder.html)** – Lightweight agent for forwarding data to Splunk
- **[Splunk Enterprise](https://www.splunk.com/en_us/download/splunk-enterprise.html)** – Centralized log analysis and dashboard platform
- **tcpdump** – Command-line packet capture tool for traffic verification

---

## 📌 Key Features

### 🔐 IDS Deployment:
- Installed Snort on Ubuntu VM
- Configured with a custom rule to **detect ICMP Echo Requests (pings)**
- Example rule added to `/etc/snort/rules/snort.rules`:
  ```snort
  alert icmp any any -> any any (msg:"ICMP Echo Request Detected"; sid:1000001;)

### 📦 Log Forwarding

- Installed and configured the **Splunk Universal Forwarder** on the Snort VM.

- Configured `outputs.conf` to forward logs to the **Splunk Enterprise** server on port `9997`:

  ```conf
  [tcpout]
  defaultGroup = default-autolb-group

  [tcpout:default-autolb-group]
  server = <SPLUNK_SERVER_IP>:9997

  [tcpout-server://<SPLUNK_SERVER_IP>:9997]


### Added a monitor on Snort’s alert log:
    ``` bash
      /opt/splunkforwarder/bin/splunk add monitor /var/log/snort/alert

###📊 Real-Time Alertin
* A Splunk dashboard was created to display alerts generated by Snort.

* ICMP (ping) alerts appear under the Search & Reporting app in the Splunk Web interface.

* Alerts are indexed in real time and visualized dynamically.
    ``` bash
    ss -tuln | grep 9997       # Confirm Splunk is listening on port 9997
    tcpdump -i enp0s8 icmp     # Monitor for ICMP packets arriving on the Snort VM
  
